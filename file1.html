<div class="block"><strong>Descriptive statistics</strong><span>&nbsp;</span>consist of describing simply the data using some<span>&nbsp;</span><strong>summary statistics</strong><span>&nbsp;</span>and graphics. Here, we&rsquo;ll describe how to compute summary statistics using<span>&nbsp;</span><strong>R</strong><span>&nbsp;</span>software.</div>
<div class="figure"><span style="font-family: LatoWeb, 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.8em;">Import your data into R</span></div>
<div id="import-your-data-into-r" class="section level1">
<ol>
<li>
<p><strong>Prepare your data</strong><span>&nbsp;</span>as specified here:<span>&nbsp;</span>Best practices for preparing your data set for R</p>
</li>
<li>
<p><strong>Save your data</strong><span>&nbsp;</span>in an external .txt tab or .csv files</p>
</li>
<li>
<p><strong>Import your data into R</strong><span>&nbsp;</span>as follow:</p>
</li>
</ol>
<pre class="r"><code class="r"><span class="comment"># If .txt tab file, use this</span>
<span class="identifier">my_data</span> <span class="operator">&lt;-</span> <span class="identifier">read.delim</span><span class="paren">(</span><span class="identifier">file.choose</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span>
<span class="comment"># Or, if .csv file, use this</span>
<span class="identifier">my_data</span> <span class="operator">&lt;-</span> <span class="identifier">read.csv</span><span class="paren">(</span><span class="identifier">file.choose</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p>Here, we&rsquo;ll use the built-in R data set named<span>&nbsp;</span><em>iris</em>.</p>
<pre class="r"><code class="r"><span class="comment"># Store the data in the variable my_data</span>
<span class="identifier">my_data</span> <span class="operator">&lt;-</span> <span class="identifier">iris</span></code></pre>
</div>
<div id="check-your-data" class="section level1">
<h1 class="wiki_paragraph1">Check your data</h1>
<p>You can inspect your data using the functions<span>&nbsp;</span><strong>head</strong>() and<span>&nbsp;</span><strong>tails</strong>(), which will display the first and the last part of the data, respectively.</p>
<pre class="r"><code class="r"><span class="comment"># Print the first 6 rows</span>
<span class="keyword">head</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="number">6</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div id="r-functions-for-computing-descriptive-statistics" class="section level1">
<h1 class="wiki_paragraph1">R functions for computing descriptive statistics</h1>
<p>Some R functions for computing descriptive statistics:</p>
<table>
<thead>
<tr class="header">
<th align="left">Description</th>
<th align="left">R function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Mean</strong></td>
<td align="left"><strong>mean</strong>()</td>
</tr>
<tr class="even">
<td align="left"><strong>Standard deviation</strong></td>
<td align="left"><strong>sd</strong>()</td>
</tr>
<tr class="odd">
<td align="left"><strong>Variance</strong></td>
<td align="left"><strong>var</strong>()</td>
</tr>
<tr class="even">
<td align="left"><strong>Minimum</strong></td>
<td align="left"><strong>min</strong>()</td>
</tr>
<tr class="odd">
<td align="left"><strong>Maximum</strong></td>
<td align="left"><strong>maximum</strong>()</td>
</tr>
<tr class="even">
<td align="left"><strong>Median</strong></td>
<td align="left"><strong>median</strong>()</td>
</tr>
<tr class="odd">
<td align="left"><strong>Range of values</strong><span>&nbsp;</span>(minimum and maximum)</td>
<td align="left"><strong>range</strong>()</td>
</tr>
<tr class="even">
<td align="left"><strong>Sample quantiles</strong></td>
<td align="left"><strong>quantile</strong>()</td>
</tr>
<tr class="odd">
<td align="left"><strong>Generic function</strong></td>
<td align="left"><strong>summary</strong>()</td>
</tr>
<tr class="even">
<td align="left"><strong>Interquartile range</strong></td>
<td align="left"><strong>IQR</strong>()</td>
</tr>
</tbody>
</table>
<p><span class="notice">The function<span>&nbsp;</span><strong>mfv</strong>(), for most frequent value, [in<span>&nbsp;</span><strong>modeest</strong><span>&nbsp;</span>package] can be used to find the statistical mode of a numeric vector.</span></p>
</div>
<div id="descriptive-statistics-for-a-single-group" class="section level1">
<h1 class="wiki_paragraph1">Descriptive statistics for a single group</h1>
<div id="measure-of-central-tendency-mean-median-mode" class="section level2">
<h2 class="wiki_paragraph2">Measure of central tendency: mean, median, mode</h2>
<p>Roughly speaking, the central tendency measures the &ldquo;average&rdquo; or the &ldquo;middle&rdquo; of your data. The most commonly used measures include:</p>
<ul>
<li>the mean: the average value. It&rsquo;s sensitive to outliers.</li>
<li>the median: the middle value. It&rsquo;s a robust alternative to mean.</li>
<li>and the mode: the most frequent value</li>
</ul>
<p>In R,</p>
<ul>
<li>The function<span>&nbsp;</span><strong>mean</strong>() and<span>&nbsp;</span><strong>median</strong>() can be used to compute the mean and the median, respectively;</li>
<li>The function<span>&nbsp;</span><strong>mfv</strong>() [in the<span>&nbsp;</span><strong>modeest</strong><span>&nbsp;</span>R package] can be used to compute the mode of a variable.</li>
</ul>
<p>The R code below computes the mean, median and the mode of the variable<span>&nbsp;</span><em>Sepal.Length</em><span>&nbsp;</span>[in<span>&nbsp;</span><em>my_data</em><span>&nbsp;</span>data set]:</p>
<pre class="r"><code class="r"><span class="comment"># Compute the mean value</span>
<span class="identifier">mean</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">[1] 5.843333</code></pre>
<pre class="r"><code class="r"><span class="comment"># Compute the median value</span>
<span class="identifier">median</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">[1] 5.8</code></pre>
<pre class="r"><code class="r"><span class="comment"># Compute the mode</span>
<span class="comment"># install.packages("modeest")</span>
<span class="keyword">require</span><span class="paren">(</span><span class="identifier">modeest</span><span class="paren">)</span>
<span class="identifier">mfv</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">[1] 5</code></pre>
</div>
<div id="measure-of-variablity" class="section level2">
<h2 class="wiki_paragraph2">Measure of variablity</h2>
<p>Measures of variability gives how &ldquo;spread out&rdquo; the data are.</p>
<div id="range-minimum-maximum" class="section level3">
<h3 class="wiki_paragraph3">Range: minimum &amp; maximum</h3>
<ul>
<li><strong>Range</strong><span>&nbsp;</span>corresponds to biggest value minus the smallest value. It gives you the full spread of the data.</li>
</ul>
<pre class="r"><code class="r"><span class="comment"># Compute the minimum value</span>
<span class="identifier">min</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">[1] 4.3</code></pre>
<pre class="r"><code class="r"><span class="comment"># Compute the maximum value</span>
<span class="identifier">max</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">[1] 7.9</code></pre>
<pre class="r"><code class="r"><span class="comment"># Range</span>
<span class="identifier">range</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">[1] 4.3 7.9</code></pre>
</div>
<div id="interquartile-range" class="section level3">
<h3 class="wiki_paragraph3">Interquartile range</h3>
<p>Recall that, quartiles divide the data into 4 parts. Note that, the<span>&nbsp;</span><strong>interquartile range</strong><span>&nbsp;</span>(IQR) - corresponding to the difference between the first and third quartiles - is sometimes used as a robust alternative to the standard deviation.</p>
<ul>
<li>R function:</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">quantile</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">probs</span> <span class="operator">=</span> <span class="identifier">seq</span><span class="paren">(</span><span class="number">0</span>, <span class="number">1</span>, <span class="number">0.25</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<br />
<div class="block">
<ul>
<li><strong>x</strong>: numeric vector whose sample quantiles are wanted.</li>
<li><strong>probs</strong>: numeric vector of probabilities with values in [0,1].</li>
</ul>
</div>
<p>&nbsp;</p>
<ul>
<li>Example:</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">quantile</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">  0%  25%  50%  75% 100% 
 4.3  5.1  5.8  6.4  7.9 </code></pre>
<p><span class="success">By default, the function returns the minimum, the maximum and three<span>&nbsp;</span><strong>quartiles</strong><span>&nbsp;</span>(the 0.25, 0.50 and 0.75 quartiles).</span></p>
<p>To compute deciles (0.1, 0.2, 0.3, &hellip;., 0.9), use this:</p>
<pre class="r"><code class="r"><span class="identifier">quantile</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span>, <span class="identifier">seq</span><span class="paren">(</span><span class="number">0</span>, <span class="number">1</span>, <span class="number">0.1</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p>To compute the interquartile range, type this:</p>
<pre class="r"><code class="r"><span class="identifier">IQR</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">[1] 1.3</code></pre>
</div>
<div id="variance-and-standard-deviation" class="section level3">
<h3 class="wiki_paragraph3">Variance and standard deviation</h3>
<p>The variance represents the average squared deviation from the mean. The standard deviation is the square root of the variance. It measures the average deviation of the values, in the data, from the mean value.</p>
<pre class="r"><code class="r"><span class="comment"># Compute the variance</span>
<span class="identifier">var</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span>
<span class="comment"># Compute the standard deviation =</span>
<span class="comment"># square root of th variance</span>
<span class="identifier">sd</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
</div>
<div id="median-absolute-deviation" class="section level3">
<h3 class="wiki_paragraph3">Median absolute deviation</h3>
<p>The median absolute deviation (MAD) measures the deviation of the values, in the data, from the median value.</p>
<pre class="r"><code class="r"><span class="comment"># Compute the median</span>
<span class="identifier">median</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span>
<span class="comment"># Compute the median absolute deviation</span>
<span class="identifier">mad</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
</div>
<div id="which-measure-to-use" class="section level3">
<h3 class="wiki_paragraph3">Which measure to use?</h3>
<ul>
<li><strong>Range</strong>. It&rsquo;s not often used because it&rsquo;s very sensitive to outliers.</li>
<li><strong>Interquartile range</strong>. It&rsquo;s pretty robust to outliers. It&rsquo;s used a lot in combination with the median.</li>
<li><strong>Variance</strong>. It&rsquo;s completely uninterpretable because it doesn&rsquo;t use the same units as the data. It&rsquo;s almost never used except as a mathematical tool</li>
<li><strong>Standard deviation</strong>. This is the square root of the variance. It&rsquo;s expressed in the same units as the data. The standard deviation is often used in the situation where the mean is the measure of central tendency.</li>
<li><strong>Median absolute deviation</strong>. It&rsquo;s a robust way to estimate the standard deviation, for data with outliers. It&rsquo;s not used very often.</li>
</ul>
<p><span class="success">In summary, the IQR and the standard deviation are the two most common measures used to report the variability of the data.</span></p>
</div>
</div>
<div id="computing-an-overall-summary-of-a-variable-and-an-entire-data-frame" class="section level2">
<h2 class="wiki_paragraph2">Computing an overall summary of a variable and an entire data frame</h2>
<div id="summary-function" class="section level3">
<h3 class="wiki_paragraph3">summary() function</h3>
<p><span class="success">The function<span>&nbsp;</span><strong>summary</strong>() can be used to display several statistic summaries of either one variable or an entire data frame.</span></p>
<ul>
<li><strong>Summary of a single variable</strong>. Five values are returned: the mean, median, 25th and 75th quartiles, min and max in one single line call:</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">summary</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  4.300   5.100   5.800   5.843   6.400   7.900 </code></pre>
<ul>
<li><strong>Summary of a data frame</strong>. In this case, the function<span>&nbsp;</span><strong>summary</strong>() is automatically applied to each column. The format of the result depends on the type of the data contained in the column. For example:
<ul>
<li>If the column is a numeric variable, mean, median, min, max and quartiles are returned.</li>
<li>If the column is a factor variable, the number of observations in each group is returned.</li>
</ul>
</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">summary</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">digits</span> <span class="operator">=</span> <span class="number">1</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">  Sepal.Length  Sepal.Width  Petal.Length  Petal.Width        Species  
 Min.   :4     Min.   :2    Min.   :1     Min.   :0.1   setosa    :50  
 1st Qu.:5     1st Qu.:3    1st Qu.:2     1st Qu.:0.3   versicolor:50  
 Median :6     Median :3    Median :4     Median :1.3   virginica :50  
 Mean   :6     Mean   :3    Mean   :4     Mean   :1.2                  
 3rd Qu.:6     3rd Qu.:3    3rd Qu.:5     3rd Qu.:1.8                  
 Max.   :8     Max.   :4    Max.   :7     Max.   :2.5                  </code></pre>
</div>
<div id="sapply-function" class="section level3">
<h3 class="wiki_paragraph3">sapply() function</h3>
<p><span class="success">It&rsquo;s also possible to use the function<span>&nbsp;</span><strong>sapply</strong>() to apply a particular function over a list or vector. For instance, we can use it, to compute for each column in a data frame, the mean, sd, var, min, quantile, &hellip;</span></p>
<pre class="r"><code class="r"><span class="comment"># Compute the mean of each column</span>
<span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">my_data</span><span class="paren">[</span>, <span class="operator">-</span><span class="number">5</span><span class="paren">]</span>, <span class="identifier">mean</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
    5.843333     3.057333     3.758000     1.199333 </code></pre>
<pre class="r"><code class="r"><span class="comment"># Compute quartiles</span>
<span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">my_data</span><span class="paren">[</span>, <span class="operator">-</span><span class="number">5</span><span class="paren">]</span>, <span class="identifier">quantile</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">     Sepal.Length Sepal.Width Petal.Length Petal.Width
0%            4.3         2.0         1.00         0.1
25%           5.1         2.8         1.60         0.3
50%           5.8         3.0         4.35         1.3
75%           6.4         3.3         5.10         1.8
100%          7.9         4.4         6.90         2.5</code></pre>
</div>
<div id="stat.desc-function" class="section level3">
<h3 class="wiki_paragraph3">stat.desc() function</h3>
<p>The function<span>&nbsp;</span><strong>stat.desc</strong>() [in<span>&nbsp;</span><strong>pastecs</strong><span>&nbsp;</span>package], provides other useful statistics including:</p>
<ul>
<li>the median</li>
<li>the mean</li>
<li>the standard error on the mean (SE.mean)</li>
<li>the confidence interval of the mean (CI.mean) at the p level (default is 0.95)</li>
<li>the variance (var)</li>
<li>the standard deviation (std.dev)</li>
<li>
<p>and the variation coefficient (coef.var) defined as the standard deviation divided by the mean</p>
</li>
<li>
<p>Install<span>&nbsp;</span><strong>pastecs</strong><span>&nbsp;</span>package</p>
</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">install.packages</span><span class="paren">(</span><span class="string">"pastecs"</span><span class="paren">)</span></code></pre>
<ul>
<li>Use the function<span>&nbsp;</span><strong>stat.desc</strong>() to compute descriptive statistics</li>
</ul>
<pre class="r"><code class="r"><span class="comment"># Compute descriptive statistics</span>
<span class="keyword">library</span><span class="paren">(</span><span class="identifier">pastecs</span><span class="paren">)</span>
<span class="identifier">res</span> <span class="operator">&lt;-</span> <span class="identifier">stat.desc</span><span class="paren">(</span><span class="identifier">my_data</span><span class="paren">[</span>, <span class="operator">-</span><span class="number">5</span><span class="paren">]</span><span class="paren">)</span>
<span class="identifier">round</span><span class="paren">(</span><span class="identifier">res</span>, <span class="number">2</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">             Sepal.Length Sepal.Width Petal.Length Petal.Width
nbr.val            150.00      150.00       150.00      150.00
nbr.null             0.00        0.00         0.00        0.00
nbr.na               0.00        0.00         0.00        0.00
min                  4.30        2.00         1.00        0.10
max                  7.90        4.40         6.90        2.50
range                3.60        2.40         5.90        2.40
sum                876.50      458.60       563.70      179.90
median               5.80        3.00         4.35        1.30
mean                 5.84        3.06         3.76        1.20
SE.mean              0.07        0.04         0.14        0.06
CI.mean.0.95         0.13        0.07         0.28        0.12
var                  0.69        0.19         3.12        0.58
std.dev              0.83        0.44         1.77        0.76
coef.var             0.14        0.14         0.47        0.64</code></pre>
</div>
</div>
<div id="case-of-missing-values" class="section level2">
<h2 class="wiki_paragraph2">Case of missing values</h2>
<p><span class="warning">Note that, when the data contains missing values, some R functions will return errors or NA even if just a single value is missing.</span></p>
<p>For example, the<span>&nbsp;</span><strong>mean()</strong><span>&nbsp;</span>function will return NA if even only one value is missing in a vector. This can be avoided using the argument<span>&nbsp;</span><strong>na.rm = TRUE</strong>, which tells to the function to remove any NAs before calculations. An example using the<span>&nbsp;</span><strong>mean</strong>function is as follow:</p>
<pre class="r"><code class="r"><span class="identifier">mean</span><span class="paren">(</span><span class="identifier">my_data</span><span class="operator">$</span><span class="identifier">Sepal.Length</span>, <span class="identifier">na.rm</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></code></pre>
</div>
<div id="graphical-display-of-distributions" class="section level2">
<h2 class="wiki_paragraph2">Graphical display of distributions</h2>
<p>The R package<span>&nbsp;</span><strong>ggpubr</strong><span>&nbsp;</span>will be used to create graphs.</p>
<div id="installation-and-loading-ggpubr" class="section level3">
<h3 class="wiki_paragraph3">Installation and loading ggpubr</h3>
<ul>
<li>Install the latest version from GitHub as follow:</li>
</ul>
<pre class="r"><code class="r"><span class="comment"># Install</span>
<span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="keyword">require</span><span class="paren">(</span><span class="identifier">devtools</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">install.packages</span><span class="paren">(</span><span class="string">"devtools"</span><span class="paren">)</span>
<span class="identifier">devtools</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">install_github</span><span class="paren">(</span><span class="string">"kassambara/ggpubr"</span><span class="paren">)</span></code></pre>
<ul>
<li>Or, install from CRAN as follow:</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">install.packages</span><span class="paren">(</span><span class="string">"ggpubr"</span><span class="paren">)</span></code></pre>
<ul>
<li>Load ggpubr as follow:</li>
</ul>
<pre class="r"><code class="r"><span class="keyword">library</span><span class="paren">(</span><span class="identifier">ggpubr</span><span class="paren">)</span></code></pre>
</div>
<div id="box-plots" class="section level3">
<h3 class="wiki_paragraph3">Box plots</h3>
<pre class="r"><code class="r"><span class="identifier">ggboxplot</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="string">"Sepal.Length"</span>, <span class="identifier">width</span> <span class="operator">=</span> <span class="number">0.5</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-box-plots-1.png" width="259.2" /></p>
</div>
<div id="histogram" class="section level3">
<h3 class="wiki_paragraph3">Histogram</h3>
<br />
<div class="block">Histograms show the number of observations that fall within specified divisions (i.e., bins).</div>
<p>&nbsp;</p>
<p>Histogram plot of Sepal.Length with mean line (dashed line).</p>
<pre class="r"><code class="r"><span class="identifier">gghistogram</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Sepal.Length"</span>, <span class="identifier">bins</span> <span class="operator">=</span> <span class="number">9</span>, 
             <span class="identifier">add</span> <span class="operator">=</span> <span class="string">"mean"</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-histogram-1.png" width="259.2" /></p>
</div>
<div id="empirical-cumulative-distribution-function-ecdf" class="section level3">
<h3 class="wiki_paragraph3">Empirical cumulative distribution function (ECDF)</h3>
<br />
<div class="block">ECDF is the fraction of data smaller than or equal to x.</div>
<p>&nbsp;</p>
<pre class="r"><code class="r"><span class="identifier">ggecdf</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Sepal.Length"</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-ecdf-1.png" width="259.2" /></p>
</div>
<div id="q-q-plots" class="section level3">
<h3 class="wiki_paragraph3">Q-Q plots</h3>
<br />
<div class="block">QQ plots is used to check whether the data is normally distributed.</div>
<p>&nbsp;</p>
<pre class="r"><code class="r"><span class="identifier">ggqqplot</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Sepal.Length"</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-qqplots-1.png" width="259.2" /></p>
</div>
</div>
</div>
<div id="descriptive-statistics-by-groups" class="section level1">
<h1 class="wiki_paragraph1">Descriptive statistics by groups</h1>
<p>To compute summary statistics by groups, the functions<span>&nbsp;</span><strong>group_by</strong>() and<span>&nbsp;</span><strong>summarise</strong>() [in<span>&nbsp;</span><strong>dplyr</strong><span>&nbsp;</span>package] can be used.</p>
<ul>
<li>We want to group the data by<span>&nbsp;</span><em>Species</em><span>&nbsp;</span>and then:
<ul>
<li>compute the number of element in each group. R function:<span>&nbsp;</span><strong>n</strong>()</li>
<li>compute the mean. R function<span>&nbsp;</span><strong>mean</strong>()</li>
<li>and the standard deviation. R function<span>&nbsp;</span><strong>sd</strong>()</li>
</ul>
</li>
</ul>
<p><span class="notice">The function<span>&nbsp;</span><strong>%&gt;%</strong><span>&nbsp;</span>is used to chaine operations.</span></p>
<ul>
<li>Install<span>&nbsp;</span><strong>ddplyr</strong><span>&nbsp;</span>as follow:</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">install.packages</span><span class="paren">(</span><span class="string">"dplyr"</span><span class="paren">)</span></code></pre>
<ul>
<li>Descriptive statistics by groups:</li>
</ul>
<pre class="r"><code class="r"><span class="keyword">library</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="paren">)</span>
<span class="identifier">group_by</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">Species</span><span class="paren">)</span> <span class="operator">%&gt;%</span> 
<span class="identifier">summarise</span><span class="paren">(</span>
  <span class="identifier">count</span> <span class="operator">=</span> <span class="identifier">n</span><span class="paren">(</span><span class="paren">)</span>, 
  <span class="identifier">mean</span> <span class="operator">=</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">Sepal.Length</span>, <span class="identifier">na.rm</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>,
  <span class="identifier">sd</span> <span class="operator">=</span> <span class="identifier">sd</span><span class="paren">(</span><span class="identifier">Sepal.Length</span>, <span class="identifier">na.rm</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>
  <span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">Source: local data frame [3 x 4]
     Species count  mean        sd
      (fctr) (int) (dbl)     (dbl)
1     setosa    50 5.006 0.3524897
2 versicolor    50 5.936 0.5161711
3  virginica    50 6.588 0.6358796</code></pre>
<ul>
<li>Graphics for grouped data:</li>
</ul>
<pre class="r"><code class="r"><span class="keyword">library</span><span class="paren">(</span><span class="string">"ggpubr"</span><span class="paren">)</span>
<span class="comment"># Box plot colored by groups: Species</span>
<span class="identifier">ggboxplot</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Species"</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="string">"Sepal.Length"</span>,
          <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"Species"</span>,
          <span class="identifier">palette</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"#00AFBB"</span>, <span class="string">"#E7B800"</span>, <span class="string">"#FC4E07"</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-grouped-data-1.png" width="384" /></p>
<pre class="r"><code class="r"><span class="comment"># Stripchart colored by groups: Species</span>
<span class="identifier">ggstripchart</span><span class="paren">(</span><span class="identifier">my_data</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Species"</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="string">"Sepal.Length"</span>,
          <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"Species"</span>,
          <span class="identifier">palette</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"#00AFBB"</span>, <span class="string">"#E7B800"</span>, <span class="string">"#FC4E07"</span><span class="paren">)</span>,
          <span class="identifier">add</span> <span class="operator">=</span> <span class="string">"mean_sd"</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-grouped-data-2.png" width="384" /></p>
<p><span class="warning">Note that, when the number of observations per groups is small, it&rsquo;s recommended to use<span>&nbsp;</span><strong>strip chart</strong><span>&nbsp;</span>compared to box plots.</span></p>
</div>
<div id="frequency-tables" class="section level1">
<h1 class="wiki_paragraph1">Frequency tables</h1>
<p>A frequency table (or contingency table) is used to describe categorical variables. It contains the counts at each combination of factor levels.</p>
<p>R function to generate tables:<span>&nbsp;</span><strong>table</strong>()</p>
<div id="create-some-data" class="section level2">
<h2 class="wiki_paragraph2">Create some data</h2>
<p>Distribution of hair and eye color by sex of 592 students:</p>
<pre class="r"><code class="r"><span class="comment"># Hair/eye color data</span>
<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">HairEyeColor</span><span class="paren">)</span>
<span class="identifier">hair_eye_col</span> <span class="operator">&lt;-</span> <span class="identifier">df</span><span class="paren">[</span><span class="identifier">rep</span><span class="paren">(</span><span class="identifier">row.names</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">df</span><span class="operator">$</span><span class="identifier">Freq</span><span class="paren">)</span>, <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="paren">]</span>
<span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">hair_eye_col</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">hair_eye_col</span><span class="paren">)</span>
<span class="keyword">head</span><span class="paren">(</span><span class="identifier">hair_eye_col</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">   Hair   Eye  Sex
1 Black Brown Male
2 Black Brown Male
3 Black Brown Male
4 Black Brown Male
5 Black Brown Male
6 Black Brown Male</code></pre>
<pre class="r"><code class="r"><span class="comment"># hair/eye variables</span>
<span class="identifier">Hair</span> <span class="operator">&lt;-</span> <span class="identifier">hair_eye_col</span><span class="operator">$</span><span class="identifier">Hair</span>
<span class="identifier">Eye</span> <span class="operator">&lt;-</span> <span class="identifier">hair_eye_col</span><span class="operator">$</span><span class="identifier">Eye</span></code></pre>
</div>
<div id="simple-frequency-distribution-one-categorical-variable" class="section level2">
<h2 class="wiki_paragraph2">Simple frequency distribution: one categorical variable</h2>
<ul>
<li>Table of counts</li>
</ul>
<pre class="r"><code class="r"><span class="comment"># Frequency distribution of hair color</span>
<span class="identifier">table</span><span class="paren">(</span><span class="identifier">Hair</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">Hair
Black Brown   Red Blond 
  108   286    71   127 </code></pre>
<pre class="r"><code class="r"><span class="comment"># Frequency distribution of eye color</span>
<span class="identifier">table</span><span class="paren">(</span><span class="identifier">Eye</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">Eye
Brown  Blue Hazel Green 
  220   215    93    64 </code></pre>
<ul>
<li>Graphics: to create the graphics, we start by converting the table as a data frame.</li>
</ul>
<pre class="r"><code class="r"><span class="comment"># Compute table and convert as data frame</span>
<span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">table</span><span class="paren">(</span><span class="identifier">Hair</span><span class="paren">)</span><span class="paren">)</span>
<span class="identifier">df</span></code></pre>
<pre><code class="inline-r-code">   Hair Freq
1 Black  108
2 Brown  286
3   Red   71
4 Blond  127</code></pre>
<pre class="r"><code class="r"><span class="comment"># Visualize using bar plot</span>
<span class="keyword">library</span><span class="paren">(</span><span class="identifier">ggpubr</span><span class="paren">)</span>
<span class="identifier">ggbarplot</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Hair"</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="string">"Freq"</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-unnamed-chunk-25-1.png" width="259.2" /></p>
</div>
<div id="two-way-contingency-table-two-categorical-variables" class="section level2">
<h2 class="wiki_paragraph2">Two-way contingency table: Two categorical variables</h2>
<pre class="r"><code class="r"><span class="identifier">tbl2</span> <span class="operator">&lt;-</span> <span class="identifier">table</span><span class="paren">(</span><span class="identifier">Hair</span> , <span class="identifier">Eye</span><span class="paren">)</span>
<span class="identifier">tbl2</span></code></pre>
<pre><code class="inline-r-code">       Eye
Hair    Brown Blue Hazel Green
  Black    68   20    15     5
  Brown   119   84    54    29
  Red      26   17    14    14
  Blond     7   94    10    16</code></pre>
<p><span class="warning">It&rsquo;s also possible to use the function<span>&nbsp;</span><strong>xtabs</strong>(), which will create cross tabulation of data frames with a formula interface.</span></p>
<pre class="r"><code class="r"><span class="identifier">xtabs</span><span class="paren">(</span><span class="operator">~</span> <span class="identifier">Hair</span> <span class="operator">+</span> <span class="identifier">Eye</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">hair_eye_col</span><span class="paren">)</span></code></pre>
<ul>
<li>Graphics: to create the graphics, we start by converting the table as a data frame.</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">tbl2</span><span class="paren">)</span>
<span class="keyword">head</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">   Hair   Eye Freq
1 Black Brown   68
2 Brown Brown  119
3   Red Brown   26
4 Blond Brown    7
5 Black  Blue   20
6 Brown  Blue   84</code></pre>
<pre class="r"><code class="r"><span class="comment"># Visualize using bar plot</span>
<span class="keyword">library</span><span class="paren">(</span><span class="identifier">ggpubr</span><span class="paren">)</span>
<span class="identifier">ggbarplot</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Hair"</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="string">"Freq"</span>,
          <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"Eye"</span>, 
          <span class="identifier">palette</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"brown"</span>, <span class="string">"blue"</span>, <span class="string">"gold"</span>, <span class="string">"green"</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-barplot-1.png" width="384" /></p>
<pre class="r"><code class="r"><span class="comment"># position dodge</span>
<span class="identifier">ggbarplot</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="string">"Hair"</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="string">"Freq"</span>,
          <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"Eye"</span>, <span class="identifier">position</span> <span class="operator">=</span> <span class="identifier">position_dodge</span><span class="paren">(</span><span class="paren">)</span>,
          <span class="identifier">palette</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"brown"</span>, <span class="string">"blue"</span>, <span class="string">"gold"</span>, <span class="string">"green"</span><span class="paren">)</span><span class="paren">)</span></code></pre>
<p><img src="http://www.sthda.com/sthda/RDoc/figure/statistics/descriptive-statistics-barplot2-1.png" width="480" /></p>
</div>
<div id="multiway-tables-more-than-two-categorical-variables" class="section level2">
<h2 class="wiki_paragraph2">Multiway tables: More than two categorical variables</h2>
<ul>
<li>Hair and Eye color distributions by sex using<span>&nbsp;</span><strong>xtabs</strong>():</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">xtabs</span><span class="paren">(</span><span class="operator">~</span><span class="identifier">Hair</span> <span class="operator">+</span> <span class="identifier">Eye</span> <span class="operator">+</span> <span class="identifier">Sex</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">hair_eye_col</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">, , Sex = Male
       Eye
Hair    Brown Blue Hazel Green
  Black    32   11    10     3
  Brown    53   50    25    15
  Red      10   10     7     7
  Blond     3   30     5     8
, , Sex = Female
       Eye
Hair    Brown Blue Hazel Green
  Black    36    9     5     2
  Brown    66   34    29    14
  Red      16    7     7     7
  Blond     4   64     5     8</code></pre>
<ul>
<li>You can also use the function<span>&nbsp;</span><strong>ftable</strong>() [for flat contingency tables]. It returns a nice output compared to xtabs() when you have more than two variables:</li>
</ul>
<pre class="r"><code class="r"><span class="identifier">ftable</span><span class="paren">(</span><span class="identifier">Sex</span> <span class="operator">+</span> <span class="identifier">Hair</span> <span class="operator">~</span> <span class="identifier">Eye</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">hair_eye_col</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">      Sex   Male                 Female                
      Hair Black Brown Red Blond  Black Brown Red Blond
Eye                                                    
Brown         32    53  10     3     36    66  16     4
Blue          11    50  10    30      9    34   7    64
Hazel         10    25   7     5      5    29   7     5
Green          3    15   7     8      2    14   7     8</code></pre>
</div>
<div id="compute-table-margins-and-relative-frequency" class="section level2">
<h2 class="wiki_paragraph2">Compute table margins and relative frequency</h2>
<p><span class="success"><strong>Table margins</strong><span>&nbsp;</span>correspond to the sums of counts along rows or columns of the table.<span>&nbsp;</span><strong>Relative frequencies</strong><span>&nbsp;</span>express table entries as proportions of table margins (i.e., row or column totals).</span></p>
<p>The function<span>&nbsp;</span><strong>margin.table</strong>() and<span>&nbsp;</span><strong>prop.table</strong>() can be used to compute table margins and relative frequencies, respectively.</p>
<ol>
<li><strong>Format of the functions</strong>:</li>
</ol>
<pre class="r"><code class="r"><span class="identifier">margin.table</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">margin</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span>
<span class="identifier">prop.table</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">margin</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span></code></pre>
<ul>
<li><strong>x</strong>: table</li>
<li><strong>margin</strong>: index number (1 for rows and 2 for columns)</li>
</ul>
<ol start="2">
<li><strong>compute table margins</strong>:</li>
</ol>
<pre class="r"><code class="r"><span class="identifier">Hair</span> <span class="operator">&lt;-</span> <span class="identifier">hair_eye_col</span><span class="operator">$</span><span class="identifier">Hair</span>
<span class="identifier">Eye</span> <span class="operator">&lt;-</span> <span class="identifier">hair_eye_col</span><span class="operator">$</span><span class="identifier">Eye</span>
<span class="comment"># Hair/Eye color table</span>
<span class="identifier">he.tbl</span> <span class="operator">&lt;-</span> <span class="identifier">table</span><span class="paren">(</span><span class="identifier">Hair</span>, <span class="identifier">Eye</span><span class="paren">)</span>
<span class="identifier">he.tbl</span></code></pre>
<pre><code class="inline-r-code">       Eye
Hair    Brown Blue Hazel Green
  Black    68   20    15     5
  Brown   119   84    54    29
  Red      26   17    14    14
  Blond     7   94    10    16</code></pre>
<pre class="r"><code class="r"><span class="comment"># Margin of rows</span>
<span class="identifier">margin.table</span><span class="paren">(</span><span class="identifier">he.tbl</span>, <span class="number">1</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">Hair
Black Brown   Red Blond 
  108   286    71   127 </code></pre>
<pre class="r"><code class="r"><span class="comment"># Margin of columns</span>
<span class="identifier">margin.table</span><span class="paren">(</span><span class="identifier">he.tbl</span>, <span class="number">2</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">Eye
Brown  Blue Hazel Green 
  220   215    93    64 </code></pre>
<ol start="3">
<li><strong>Compute relative frequencies</strong>:</li>
</ol>
<pre class="r"><code class="r"><span class="comment"># Frequencies relative to row total</span>
<span class="identifier">prop.table</span><span class="paren">(</span><span class="identifier">he.tbl</span>, <span class="number">1</span><span class="paren">)</span></code></pre>
<pre><code class="inline-r-code">       Eye
Hair         Brown       Blue      Hazel      Green
  Black 0.62962963 0.18518519 0.13888889 0.04629630
  Brown 0.41608392 0.29370629 0.18881119 0.10139860
  Red   0.36619718 0.23943662 0.19718310 0.19718310
  Blond 0.05511811 0.74015748 0.07874016 0.12598425</code></pre>
<pre class="r"><code class="r"><span class="comment"># Table of percentages</span>
<span class="identifier">round</span><span class="paren">(</span><span class="identifier">prop.table</span><span class="paren">(</span><span class="identifier">he.tbl</span>, <span class="number">1</span><span class="paren">)</span>, <span class="number">2</span><span class="paren">)</span><span class="operator">*</span><span class="number">100</span></code></pre>
<pre><code class="inline-r-code">       Eye
Hair    Brown Blue Hazel Green
  Black    63   19    14     5
  Brown    42   29    19    10
  Red      37   24    20    20
  Blond     6   74     8    13</code></pre>
<p>To express the frequencies relative to the grand total, use this:</p>
<pre class="r"><code class="r"><span class="identifier">he.tbl</span><span class="operator">/</span><span class="identifier">sum</span><span class="paren">(</span><span class="identifier">he.tbl</span><span class="paren">)</span></code></pre>
</div>
</div>
